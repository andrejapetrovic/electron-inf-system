
<div>
  <br>
  <div class="col-sm-12" style="background-color: whitesmoke">
      <div class="row">
        <div class="col-sm-2">
          <label>Ime</label>
          <input class="form-control" type="text" [(ngModel)]="ime" [ngbTypeahead]="searchService.searchImena"/>
        </div>
        <div class="col-sm-2">
            <label>Prezime</label>
            <input class="form-control" type="text" [(ngModel)]="prz" [ngbTypeahead]="searchService.searchPrezimena"/>
        </div>
        <div class="col-sm-2">
          <label>Fakultet</label>
          <input class="form-control" type="text" [(ngModel)]="fakultet" [ngbTypeahead]="searchService.searchFakulteti"/>
      </div>
      <div class="col-sm-2">
        <label>Smer</label>
        <input class="form-control" type="text" [(ngModel)]="smer" [ngbTypeahead]="searchService.searchSmerovi"/>
    </div>
    <div class="col-sm-2">
      <label>Godina upisa</label>
      <input class="form-control" type="text" [(ngModel)]="godUpis" [ngbTypeahead]="searchService.searchSkGod"/>
    </div>
    <div class="col-sm-2">
      <label>Godina studija</label>
      <input class="form-control" type="text" [(ngModel)]="godStud"/>
    </div>
      </div><br>

      <div class="row">
        <div class="col-sm-2">
          <label>Školska godina učlanjenja</label>
          <input class="form-control" type="text" [(ngModel)]="godUcl" [ngbTypeahead]="searchService.searchSkGod"/>
        </div>
        <div class="col-sm-2">
            <label>Dijagnoza</label>
            <input class="form-control" type="text" [(ngModel)]="dijagnoza" [ngbTypeahead]="searchService.searchDijagnoze"/>
        </div>
        <div class="col-sm-2">
          <label>Dodatna podrška</label>
          <input class="form-control" type="text" [(ngModel)]="dodatnaPodrska" [ngbTypeahead]="searchService.searchDp"/>
      </div>
      <div class="col-sm-2">
        <label>Jezici</label>
        <input class="form-control" type="text" [(ngModel)]="jezici" [ngbTypeahead]="searchService.searchJezici"/>
    </div>
    <div class="col-sm-2">
      <label>Računarske veštine</label>
      <input class="form-control" type="text" [(ngModel)]="racVest" [ngbTypeahead]="searchService.searchRv"/>
    </div>
    <div class="col-sm-2">
      <label>Druge organizacije</label>
      <input class="form-control" type="text" [(ngModel)]="studOrgs" [ngbTypeahead]="searchService.searchOrgs"/>
    </div>
      </div><br>

      <div class="row">
        <div class="col-sm-2">
          <label>Mesto Rodjenja</label>
          <input class="form-control" type="text" [(ngModel)]="mestoRodj" [ngbTypeahead]="searchService.searchMesta"/>
        </div>
        <div class="col-sm-2">
            <label>Mesto stanovanja</label>
            <input class="form-control" type="text" [(ngModel)]="mestoStan" [ngbTypeahead]="searchService.searchMesta"/>
        </div>
        <div class="col-sm-2">
            <label>Ulica</label>
            <input class="form-control" type="text" [(ngModel)]="ulica" [ngbTypeahead]="searchService.searchUlice"/>
        </div>
        <div class="col-sm-2">
          <label>Godine prisustva skupštini</label>
          <input class="form-control" type="text" [(ngModel)]="prisSkup" [ngbTypeahead]="searchService.searchSkGod"/>
      </div>
      <div class="col-sm-2">
        <label>Druge veštine</label>
        <input class="form-control" type="text" [(ngModel)]="drugeVes" [ngbTypeahead]="searchService.searchDv"/>
    </div>
    <div class="col-sm-2">
      <label>Način polaganja ispita</label>
      <input class="form-control" type="text" [(ngModel)]="ispit" [ngbTypeahead]="searchService.searchIspiti"/>
    </div>
      </div><br>

      <div class="row">
        <div class="col-sm-12">
          <div class="form-check form-check-inline">
              <label class="filter-label" for="rv">Radioničarske veštine:</label>&nbsp;&nbsp;
              <input class="form-check-input" type="checkbox" id="rv" [(ngModel)]="radVesDa">
              <label class="form-check-label" for="rv">
                  DA
              </label>&nbsp;&nbsp;
              <input name="radVes" class="form-check-input" type="checkbox" value="" id="rvne" [(ngModel)]="radVesNe">
              <label class="form-check-label" for="rvne">
                  NE
              </label>
            </div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <div class="col-check form-check-inline">
                <label class="filter-label" for="pproj">Pisanje projekata:</label>&nbsp;&nbsp;
                <input class="form-check-input" type="checkbox" id="pproj" [(ngModel)]="pprojDa">
                <label class="form-check-label" for="pproj">
                  DA
                </label>&nbsp;&nbsp;
                <input class="form-check-input" type="checkbox" id="pprojNe" [(ngModel)]="pprojNe">
                <label class="form-check-label" for="pprojNe">
                  NE
                </label>
            </div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <div class="col-check form-check-inline">
              <label class="filter-label" for="aktivan">Aktivan:</label>&nbsp;&nbsp;
                <input class="form-check-input" type="checkbox"id="aktivan" [(ngModel)]="aktivanDa">
                <label class="form-check-label" for="aktivan">
                  DA
                </label>&nbsp;&nbsp;
                <input class="form-check-input" type="checkbox" id="aktivanNe" [(ngModel)]="aktivanNe">
                <label class="form-check-label" for="aktivanNe">
                  NE
                </label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            </div>
            <div class="col-check form-check-inline">
                <label class="filter-label" for="aktivan">Suspendovan:</label>&nbsp;&nbsp;
                  <input class="form-check-input" type="checkbox" id="susp" [(ngModel)]="suspDa">
                  <label class="form-check-label" for="susp">
                    DA
                  </label>&nbsp;&nbsp;
                  <input class="form-check-input" type="checkbox" id="suspNe" [(ngModel)]="suspNe">
                  <label class="form-check-label" for="suspNe">
                    NE
                  </label>&nbsp;&nbsp;
              </div>
        </div>
      </div><br>
            <div class="row">
              <div class="col-sm-12">
                <div class="col-check form-check-inline">
                  <form class="form-inline" (ngSubmit)="prikazClnZaGod(clnForm.value.cln)" #clnForm="ngForm">
                      <label for="god" class="mr-sm-2">Prikaži članarine za školsku godinu</label>
                        <input type="text" class="form-control mb-2 mr-sm-2 col-sm-3" id="god" [value]="clanarina" 
                          [ngModel]="clanarina" name="cln" [ngbTypeahead]="searchService.searchSkGod">
                      <button type="submit" class="btn btn-outline-dark mb-2">Potvrdi</button>
                      &nbsp;&nbsp;&nbsp;
                      <label for="pc">Plaćene članarine:</label>&nbsp;&nbsp;
                      <input class="form-check-input" type="checkbox" [(ngModel)]="clnDa" id="pc" name="clnDa">
                      <label class="form-check-label" for="pc">
                        DA
                      </label>&nbsp;&nbsp;
                      <input class="form-check-input" type="checkbox" [(ngModel)]="clnNe" id="pcNe" name="clnNe">
                      <label class="form-check-label" for="pcNe">
                        NE
                      </label>
                    </form>
                  </div>
                </div>
              </div>
      
    
</div><br>
<table class="table table-bordered table-striped">
  <thead>
  <tr>
    <th class="btn-th"></th>
    <th scope="col" sortable="ime" (sort)="onSort($event)">Ime</th>
    <th scope="col" sortable="prz" (sort)="onSort($event)">Prezime</th>
    <th scope="col">Članarina {{clanarina}}</th>
    <th scope="col">Datum učlanjena</th>
    <th scope="col">Godina učlanjena</th>
    <th scope="col" sortable="fakultet" (sort)="onSort($event)">Fakultet</th>
    <th scope="col" sortable="smer" (sort)="onSort($event)">Smer</th>
    <th scope="col" sortable="godUpis" (sort)="onSort($event)">Godina upisa</th>
    <th scope="col" sortable="godStud" (sort)="onSort($event)">Godina studija</th>
    <th scope="col">Mesto stanovanja</th>
    <th scope="col">Ulica</th>
    <th scope="col">Mesto rođenja</th>
    <th scope="col">Datum rođenja</th>
    <th scope="col">Broj fiksnog</th>
    <th scope="col">Broj mobilnog</th>
    <th scope="col">JMBG</th>
    <th scope="col">Broj lične karte</th>
    <th scope="col">Član</th>
    <th scope="col">Tip invaliditeta</th>
    <th scope="col">Dijagnoza</th>
    <th scope="col">Dodatna podrska</th>
    <th scope="col">Jezici</th>
    <th scope="col">Računarske veštine</th>
    <th scope="col">Druge organizacije</th>
    <th scope="col">Pisanje projekata</th>
    <th scope="col">Radioničarske veštine</th>
    <th scope="col">Stepen aktivnosti</th>
    <th scope="col">Druge veštine</th>
    <th scope="col">Način polaganja ispita</th>
    <th scope="col">Prisustvo skupštini</th>
  </tr>
  </thead>
  <tbody>
  <tr *ngFor="let stud of dataService.students | filterTable: ime: prz: fakultet: smer: godUpis: godStud:
   godUcl: dijagnoza: dodatnaPodrska: jezici: racVest: studOrgs: mestoRodj: mestoStan: ulica: prisSkup: drugeVes: ispit:
   radVesDa: radVesNe: pprojDa: pprojNe: aktivanDa: aktivanNe: suspDa: suspNe: clnDa: clnNe; index as i">
    <div *ngIf="stud.editable; then editRow else basicRow"></div>
    <ng-template #basicRow>
      <td class="btn-td">
          <div class="btn-group float-right">
            <button *ngIf="stud.susp" class="btn btn-danger btn-sm" (click)="openSuspensions(stud)" onclick="this.blur();"
              ngbPopover="{{stud.suspRazlog}}" popoverTitle="SUSPENDOVAN {{stud.suspDat}}" triggers="mouseenter:mouseleave">
                <fa name="exclamation-circle" size="lg"></fa>
            </button>
            <button *ngIf="!stud.susp" class="btn btn-outline-dark btn-sm" onclick="this.blur();"
            ngbPopover="Suspenduj" triggers="mouseenter:mouseleave" (click)="openSuspModal(content, stud)">
              <fa name="user-times" size="lg"></fa>
            </button>
              <button class="btn btn-outline-dark btn-sm" (click)="stud.editable = true" onclick="this.blur();"
              ngbPopover="Ažuriraj" triggers="mouseenter:mouseleave">
                <fa name="edit" size="lg"></fa>
              </button>
              <button class="btn btn-outline-dark btn-sm" (click)="openEdit(stud)" onclick="this.blur();"
              ngbPopover="Otvori upisnicu" triggers="mouseenter:mouseleave">
                  <fa name="external-link-square" size="lg"></fa>
              </button>
            </div>
      </td>
      <td (dblclick)="stud.editable = true">{{ stud.ime }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.prz }}</td>
      <td>
        <div *ngIf="stud.clanarina; then placena else neplacena"></div>
        <ng-template #placena><span style="color: green; font-weight: 500">PLAĆENA</span></ng-template>
        <ng-template #neplacena>
            <span style="color: red; font-weight: 500">NEPLAĆENA</span>&nbsp;
            <span *ngIf="!stud.clanarina" (click)="openClnModal(contentCln, stud)" class="rucica"
            ngbPopover="Potvrdi plaćanje" triggers="mouseenter:mouseleave" style="color: black">
            <fa name="plus"></fa>
          </span>
        </ng-template>&nbsp;
          <span (click)="openFees(stud)" class="rucica float-right" style="color:black"
          ngbPopover="Detaljno" triggers="mouseenter:mouseleave">
          <fa name="external-link-square" size="lg"></fa>
      </span>
      </td>
      <td (dblclick)="stud.editable = true">{{ stud.datUcl }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.godUcl }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.fakultet }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.smer }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.godUpis }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.godStud | number }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.mestoStan }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.ulica }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.mestoRodj }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.dat }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.tel }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.mob }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.jmbg }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.brLicne }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.tip }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.tipInv }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.dijagnoza }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.dodatnaPodrska }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.jezici }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.racVest }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.studOrgs }}</td>
      <td (dblclick)="stud.editable = true">
          <span *ngIf="stud.pisanjeProj">DA</span>
          <span *ngIf="!stud.pisanjeProj">NE</span>
      </td>
      <td (dblclick)="stud.editable = true">
          <span *ngIf="stud.radVes">DA</span>
          <span *ngIf="!stud.radVes">NE</span>
      </td>
      <td (dblclick)="stud.editable = true">
        <span *ngIf="stud.aktivan">AKTIVAN</span>
        <span *ngIf="!stud.aktivan">NEAKTIVAN</span>
      </td>
      <td (dblclick)="stud.editable = true">{{ stud.drugeVes }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.ispit }}</td>
      <td (dblclick)="stud.editable = true">{{ stud.prisSkup }}</td>
      <td class="btn-td">
          <button class="btn btn-danger btn-sm" (click)="archive(stud)">arhiviraj</button>
      </td>
      <td class="btn-td">
          <button class="btn btn-danger btn-sm" (click)="archive(stud)">arhiviraj</button>
        </td>

    </ng-template>
    <ng-template #editRow>
      <td class="btn-td"><button class="btn btn-success btn-sm" (click)="editStudentRow(i)">
          <fa name="save" size="lg"></fa>
      </button></td>
      <td><input type="text" class="form-control" [(ngModel)]="stud.ime" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.prz" (keyup.enter)="editStudentRow(i)"/></td>
      <td>
          <div *ngIf="stud.clanarina; then placena else neplacena"></div>
          <ng-template #placena>Plaćena</ng-template>
          <ng-template #neplacena>Neplaćena
              <span *ngIf="!stud.clanarina" (click)="openClnModal(contentCln, stud)" class="rucica"
              ngbPopover="Potvrdi plaćanje" triggers="mouseenter:mouseleave" style="color: #3478F7">
              <fa name="plus"></fa>
          </span>
          </ng-template>&nbsp;
            <span *ngIf="!stud.clanarina" (click)="openFees(stud)" class="rucica float-right" style="color: #3478F7"
            ngbPopover="Detaljno" triggers="mouseenter:mouseleave">
            <fa name="external-link-square" size="lg"></fa>
        </span>
        </td>
        <td><input type="text" class="form-control " [(ngModel)]="stud.datUcl" (keyup.enter)="editStudentRow(i)"/></td>
        <td><input type="text" class="form-control " [(ngModel)]="stud.godUcl" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.fakultet" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.smer" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.godUpis" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.godStud" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.mestoStan" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.ulica" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.mestoRodj" (keyup.enter)="editStudentRow(i)"></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.dat" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.tel" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.mob" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.jmbg" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.brLicne" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.tip" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.tipInv" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.dijagnoza" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.dodatnaPodrska" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.jezici" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.racVest" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.studOrgs" (keyup.enter)="editStudentRow(i)"/></td>
      <td>
          <label class="label">
              <div class="toggle">
                <input class="toggle-state" type="checkbox" [checked]="stud.pisanjeProj" (change)="stud.pisanjeProj = !stud.pisanjeProj"/>
                <div class="toggle-inner">
                   <div class="indicator"></div>
                </div>
                <div class="active-bg"></div>
              </div>
              <div *ngIf="stud.pisanjeProj" class="label-text">DA</div>
              <div *ngIf="!stud.pisanjeProj" class="label-text">NE</div>  
            </label>
      <td>
          <label class="label">
              <div class="toggle">
                <input class="toggle-state" type="checkbox" [checked]="stud.radVes" (change)="stud.radVes = !stud.radVes"/>
                <div class="toggle-inner">
                   <div class="indicator"></div>
                </div>
                <div class="active-bg"></div>
              </div>
              <div *ngIf="stud.radVes" class="label-text">DA</div>
              <div *ngIf="!stud.radVes" class="label-text">NE</div>  
            </label>
      </td>
      <td>
          <label class="label">
              <div class="toggle">
                <input class="toggle-state" type="checkbox" [checked]="stud.aktivan" (change)="stud.aktivan = !stud.aktivan"/>
                <div class="toggle-inner">
                   <div class="indicator"></div>
                </div>
                <div class="active-bg"></div>
              </div>
              <div *ngIf="stud.aktivan" class="label-text">AKTIVAN</div>
              <div *ngIf="!stud.aktivan" class="label-text">NEAKTIVAN</div>  
            </label>
      </td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.drugeVes" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.ispit" (keyup.enter)="editStudentRow(i)"/></td>
      <td><input type="text" class="form-control " [(ngModel)]="stud.prisSkup" (keyup.enter)="editStudentRow(i)"/></td>
      <td class="btn-td">
          <button class="btn btn-danger btn-sm" (click)="archive(stud)">arhiviraj</button>
      </td>
    </ng-template>
  </tr>
  </tbody>
</table>

</div>
<ng-template #content let-modal>
    <div class="modal-header">
      <h4 class="modal-title" id="modal-basic-title">Nova suspenzija</h4>
      <span type="button" class="close rucica" aria-label="Close" (click)="modal.dismiss('Cross click')">
        <span aria-hidden="true">&times;</span>
      </span>
    </div>
    <div class="modal-body">
      <form (ngSubmit)="saveSusp(modalSuspForm)" #modalSuspForm="ngForm">
        <div class="form-group">
          <label for="razlog">Razlog</label>
          <div class="input-group">
            <input type="text" id="razlog" class="form-control" ngModel name="razlog">
          </div>
          <label for="dodatnaPodrska">Datum</label>
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <label for="god">Godina suspenzije</label>
          <div class="input-group">
            <input type="text" id="dat" class="form-control" ngModel name="datSusp">&nbsp;
            <input type="text" id="god" class="form-control" ngModel name="godSusp">&nbsp;
            <input type="submit" class="btn btn-outline-dark" value="Potvrdi suspenziju" />
          </div>
        </div>
      </form>
      </div>
  </ng-template>

  <ng-template #contentCln let-modal>
      <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Potvrda uplaćene članarine</h4>
        <span class="close rucica" aria-label="Close" (click)="modal.dismiss('Cross click')">
          <span aria-hidden="true">&times;</span>
        </span>
      </div>
      <div class="modal-body">
        <form (ngSubmit)="platiCln(modalClnForm)" #modalClnForm="ngForm">
          <div class="form-group">
            <label for="dat">Datum uplate</label>
            <div class="input-group">
              <input type="text" id="dat" class="form-control" ngModel name="datPlacanja">&nbsp;
              <input type="submit" class="btn btn-outline-dark" value="Potvrdi uplatu" />
            </div>
          </div>
        </form>
        </div>
    </ng-template>

